script_name('Spawner simples')
script_author('GEEK')
script_description('Use cheat "VEH" para ativar,  roda do mouse para selecionar, bot√£o "TARGET confirma.')

local valmod = 400
local valmin = 400
local valmax = 611
local vehicleID = -1
local GxtString = nil

function main()
  while true do
    wait(40)
	if isPlayerControlOn(PLAYER_HANDLE) then
		if testCheat('VEH') then
			if not doesVehicleExist(getCarCharIsUsing(PLAYER_PED)) then
				setPlayerControl(PLAYER_HANDLE, false)
				setCameraBehindPlayer()
				newCar(valmod)
				local nextVal = 0
				while not isButtonPressed(PLAYER_HANDLE, 6) do
					wait(10)
					local delta = getMousewheelDelta()
					valmod = valmod + delta
					if valmod < valmin then valmod = valmax end
					if valmod > valmax then valmod = valmin end
					if nextVal ~= valmod then 
						newCar(valmod)
						nextVal = valmod
					end
					if checkVehicleType(valmod) then
						GxtString = getNameOfVehicleModel(valmod)
						GxtString = getGxtText(GxtString)
					else
						GxtString = "~r~Veiculo sem nome?"
					end
					printStringNow('Nome do veiculo~n~~y~' .. GxtString .. '~n~~w~(' .. valmod ..')', 250)
				end
				setPlayerControl(PLAYER_HANDLE, true)
				restoreCamera()
			end
		end
	  end
  end
end

function newCar(int_model, isDiscartable)
	if doesVehicleExist(vehicleID) then deleteCar(vehicleID) end
	if isPlayerPlaying(PLAYER_HANDLE) then
		if checkVehicleType(int_model) then
			local floatX, floatY, floatZ = getOffsetFromCharInWorldCoords(PLAYER_PED, 0.0, 6.0, 0.0)
			local floatA = getCharHeading(PLAYER_PED)
			if not hasModelLoaded(int_model) then
				requestModel(int_model)
				loadAllModelsNow()
			end
			vehicleID = createCar(int_model, floatX, floatY, floatZ)
			setCarHeading(vehicleID, floatA + 90.0)
			markModelAsNoLongerNeeded(int_model)
			if isDiscartable == nil then markCarAsNoLongerNeeded(vehicleID) end
		end
	end
end

function checkVehicleType(int_model)
	if int_model <= 99999 and int_model >= 0 then
		if isModelAvailable(int_model) then 
			--if isThisModelABoat(int_model) 
			--or isThisModelACar(int_model)
			--or isThisModelAHeli(int_model)
			--or isThisModelAPlane(int_model) then
				return true
			--end
		end
	end
	return false
end
